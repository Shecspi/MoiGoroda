{% load mathfilters %}

<!-- Статистика -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div>
        <h6 class="text-sm font-semibold text-gray-800 dark:text-neutral-300 mb-2">Средняя оценка среди всех пользователей:</h6>
        <div class="flex items-center gap-3">
            {% if average_rating %}
                <span class="text-lg font-semibold text-gray-900 dark:text-white">
                    {{ average_rating }}
                </span>
                <div class="flex items-center gap-0.5">
                    {% for i in "12345"|make_list %}
                        {% with index=forloop.counter %}
                            {% if average_rating >= index %}
                                <svg xmlns="http://www.w3.org/2000/svg" class="size-5 text-yellow-400" viewBox="0 0 576 512" fill="currentColor">
                                    <path d="M287.9 0c9.2 0 17.6 5.2 21.6 13.5l68.6 141.3 153.2 22.6c9 1.3 16.5 7.6 19.3 16.3s.5 18.1-5.9 24.5L433.6 328.4l26.2 155.6c1.5 9-2.2 18.1-9.6 23.5s-17.3 6-25.3 1.7l-137-73.2L151 509.1c-8.1 4.3-17.9 3.7-25.3-1.7s-11.2-14.5-9.7-23.5l26.2-155.6L31.1 218.2c-6.5-6.4-8.7-15.9-5.9-24.5s10.3-14.9 19.3-16.3l153.2-22.6L266.3 13.5C270.4 5.2 278.7 0 287.9 0z"/>
                                </svg>
                            {% else %}
                                {% if average_rating >= index|sub:0.5 %}
                                    <svg xmlns="http://www.w3.org/2000/svg" class="size-5 text-yellow-400" viewBox="0 0 640 512" fill="currentColor">
                                        <path d="M320 0c-9.2 0-17.6 5.2-21.6 13.5l-68.6 141.3L136.6 177c-9 1.3-16.5 7.6-19.3 16.3s-.5 18.1 5.9 24.5L218.4 328.4l-26.2 155.6c-1.5 9 2.2 18.1 9.6 23.5s17.3 6 25.3 1.7L320 402.1l137 73.2c8.1 4.3 17.9 3.7 25.3-1.7s11.2-14.5 9.7-23.5L456.6 328.4l95.2-110.6c6.5-6.4 8.7-15.9 5.9-24.5s-10.3-14.9-19.3-16.3L375.2 155l-68.6-141.3C302.4 5.2 294.1 0 284.9 0H320zm0 64v0z"/>
                                    </svg>
                                {% else %}
                                    <svg xmlns="http://www.w3.org/2000/svg" class="size-5 text-gray-300 dark:text-neutral-600" viewBox="0 0 576 512" fill="currentColor">
                                        <path d="M287.9 0c9.2 0 17.6 5.2 21.6 13.5l68.6 141.3 153.2 22.6c9 1.3 16.5 7.6 19.3 16.3s.5 18.1-5.9 24.5L433.6 328.4l26.2 155.6c1.5 9-2.2 18.1-9.6 23.5s-17.3 6-25.3 1.7l-137-73.2L151 509.1c-8.1 4.3-17.9 3.7-25.3-1.7s-11.2-14.5-9.7-23.5l26.2-155.6L31.1 218.2c-6.5-6.4-8.7-15.9-5.9-24.5s10.3-14.9 19.3-16.3l153.2-22.6L266.3 13.5C270.4 5.2 278.7 0 287.9 0z"/>
                                    </svg>
                                {% endif %}
                            {% endif %}
                        {% endwith %}
                    {% endfor %}
                </div>
            {% else %}
                <span class="text-sm text-gray-500 dark:text-neutral-500">Статистика ещё не собрана</span>
            {% endif %}
        </div>
    </div>

    <div>
        <h6 class="text-sm font-semibold text-gray-800 dark:text-neutral-300 mb-2">Популярные месяцы для посещения:</h6>
        <div class="text-sm text-gray-600 dark:text-neutral-400">
            {% if popular_months %}
                {{ popular_months|join:", " }}
            {% else %}
                <span class="text-gray-500 dark:text-neutral-500">Статистика ещё не собрана</span>
            {% endif %}
        </div>
    </div>
</div>

