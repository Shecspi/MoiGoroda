{% extends 'base.html' %}
{% load vite %}
{% load static %}

{% block extra_css %}
    {{ block.super }}
    {% vite_css 'css/tailwind' %}
    {% vite_css 'css/leaflet-controls' %}
{% endblock %}

{% block content %}
{% if not DEBUG %}
    {% if not user.is_authenticated %}
        {% include 'advertisement/rtb_floor_fullscreen_mobile.html' %}
    {% endif %}
{% endif %}

{% include 'city/detail/sections/header.html' %}

{% if not user.is_authenticated %}
    {% include 'advertisement/rtb_floor_fullscreen_mobile.html' %}
{% endif %}

<div class="mx-3 mb-8 flex justify-center">
    <div class="w-full max-w-6xl">
        <!-- Основная карточка с информацией о городе -->
        <div class="rounded-xl border border-gray-200 bg-white p-6 shadow-sm dark:border-neutral-700 dark:bg-neutral-900 mb-6" id="city-selected-content">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Изображение города -->
                {% include 'city/detail/sections/image_section.html' %}

                <!-- Информация о городе -->
                <div class="space-y-4">
                    <!-- Кнопки действий -->
                    {% include 'city/detail/sections/action_buttons.html' %}

                    <!-- Основная информация -->
                    {% include 'city/detail/sections/basic_info.html' %}

                    <hr class="border-gray-200 dark:border-neutral-700">

                    <!-- Коллекции -->
                    {% include 'city/detail/sections/collections.html' %}

                    <hr class="border-gray-200 dark:border-neutral-700">

                    <!-- Статистика -->
                    {% include 'city/detail/sections/statistics.html' %}

                    <hr class="border-gray-200 dark:border-neutral-700">

                    <!-- Ссылка на Wikipedia -->
                    {% if city.wiki %}
                        <div class="flex justify-end">
                            <a href="{{ city.wiki }}"
                               class="inline-flex items-center gap-x-2 text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 hover:underline"
                               target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" class="size-4" viewBox="0 0 640 640" fill="currentColor">
                                    <path d="M640 115.2L639.7 127.4C611.6 128.2 594.7 143.2 583.9 167.7C558.9 225.5 480.6 407.7 428.6 526.3L415 526.3L333.1 333.2C300.6 396.8 264.8 463.2 233.9 526.3C233.6 526.6 218.9 526.3 218.9 526C172 416.3 122.8 307.4 75.8 197.4C64.4 170.7 26.4 127.4 .2 127.7C.2 124.6-.1 117.7-.1 113.5L161.8 113.5L161.8 127.4C142.6 128.5 109 140.7 118.5 161.6C140.4 211.3 222.1 401.9 244.1 450.2C259.1 420.5 301.9 341 319.4 307.4C305.5 279.1 260.8 173.5 246.6 147.4C236.9 129.6 210.5 128 190.8 127.7L190.8 113.8L333.3 114.1L333.3 127.2C313.9 127.8 295.2 135 303.9 153.3C322.8 193.3 334.5 221.4 352 258C357.6 247.2 386.7 188.6 400.1 157.2C409 136.6 396.2 128.6 361.5 127.8C361.8 124.2 361.5 117.5 361.8 114.2C406.2 113.9 472.9 113.9 484.9 113.6L484.9 127.2C462.4 128 439.1 140 426.8 158.9L367.6 281.7C374 297.8 430.9 424.5 436.8 438.4L559.2 155.8C550.6 132.7 522.8 127.7 512 127.5L512 113.6L639.8 114.7L640 115.2z"/>
                                </svg>
                                Больше информации о городе на Wikipedia
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Посещения пользователя -->
            {% include 'city/detail/sections/user_visits.html' %}
        </div>
    </div>
</div>

{% if not DEBUG %}
    {% include 'advertisement/rtb_feed.html' %}

    {% if not user.is_authenticated %}
        {% include 'advertisement/rtb_floor_ad_mobile.html' %}
        {% include 'advertisement/rtb_floor_ad_desktop.html' %}
    {% endif %}
{% endif %}

<!-- Модальные окна -->
{% include 'city/detail/modals/statistics.html' %}
{% include 'city/detail/modals/map.html' %}
{% include 'city/detail/modals/delete.html' %}

<script>
    window.CITY_TITLE = "{{ city.title }}";
    window.LAT = "{{ city.coordinate_width }}";
    window.LON = "{{ city.coordinate_longitude }}";
    window.ISO3166 = "{{ city.region.iso3166 }}"
    window.COUNTRY_CODE = "{{ city.country.code }}"
    window.TILE_LAYER = "{{ TILE_LAYER }}";
    window.URL_GEO_POLYGONS = "{{ URL_GEO_POLYGONS }}"
</script>
{% vite_asset 'js/entries/leaflet_css.js' %}
{% vite_asset 'js/entries/map_city_selected.js' %}
{% endblock %}

