{% extends 'head.html' %}
{% load vite %}
{% load static %}

{% block base %}
    {% include 'parts/js_isAuthenticated.html' %}


    <div class="flex">
        {% include 'parts/sidebar.html' %}

        <div class="flex min-h-screen w-full flex-col xl:pl-80" id="section-content">
            <!-- Навбар для маленьких экранов -->
            <nav class="xl:hidden fixed top-0 left-0 right-0 z-[100] border-b border-gray-200 bg-white dark:border-neutral-700 dark:bg-neutral-900">
                <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
                    <div class="flex h-16 items-center justify-between">
                        <!-- Кнопка открытия сайдбара -->
                        <button type="button"
                                id="sidebar-toggle"
                                class="relative inline-flex items-center justify-center rounded-lg p-2 text-gray-600 border border-gray-200 hover:bg-gray-100 hover:text-gray-900 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-neutral-400 dark:border-neutral-700 dark:hover:bg-neutral-800 dark:hover:text-neutral-200 dark:hover:border-neutral-600"
                                aria-label="Открыть меню"
                                aria-expanded="false">
                            <svg class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                            </svg>
                            <!-- Уведомление о наличии бейджика с новостями в меню -->
                            {% if has_unread_news %}
                                <span class="absolute -right-1 -top-1 inline-flex h-3 w-3 rounded-full bg-red-500 ring-2 ring-white dark:ring-neutral-900">
                                    <span class="sr-only">Новые уведомления</span>
                                </span>
                            {% endif %}
                        </button>

                        <!-- Логотип -->
                        <a class="absolute left-1/2 -translate-x-1/2 font-pacifico text-2xl text-gray-900 dark:text-white"
                           href="{% url 'main_page' %}">
                           Мои&nbsp;&nbsp;<i class="fa-solid fa-map-location-dot"></i>&nbsp;&nbsp;города
                        </a>

                        <!-- Кнопка уведомлений -->
                        {% if user.is_authenticated %}
                            <button type="button"
                                    class="relative inline-flex items-center justify-center rounded-lg p-2 text-gray-600 border border-gray-200 hover:bg-gray-100 hover:text-gray-900 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-neutral-400 dark:border-neutral-700 dark:hover:bg-neutral-800 dark:hover:text-neutral-200 dark:hover:border-neutral-600 cursor-pointer"
                                    id="notification_icon"
                                    data-bs-toggle="modal"
                                    data-bs-target="#notificationModal"
                                    aria-label="Открыть уведомления">
                                <svg class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true" id="bell">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
                                </svg>
                            </button>
                        {% endif %}
                    </div>
                </div>
            </nav>

            <!-- Отступ для фиксированного навбара на мобильных устройствах -->
            <div class="xl:hidden h-16"></div>

            {% block content %}
            {% endblock %}

            {% include 'parts/footer.html' %}
        </div>
    </div>

    <!-- Overlay backdrop для маленьких экранов -->
    <div id="sidebar-backdrop"
         class="xl:hidden fixed inset-0 z-[1049] bg-gray-900/50 transition-opacity duration-300 opacity-0 pointer-events-none"
         aria-hidden="true"></div>

    {% include 'parts/notification_controls.html' %}
    {% if user.is_authenticated %}
        {% vite_asset 'js/entries/notification.js' %}
    {% endif %}

    {% vite_asset 'js/entries/sidebar.js' %}
    
    {% block modals %}{% endblock %}
{% endblock %}

{% block extra_js %}
    {{ block.super }}
    {% vite_asset 'js/entries/preline.js' %}
{% endblock %}
